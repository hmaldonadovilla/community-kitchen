openapi: 3.0.0
info:
  title: Community Kitchen Config Sheet Schema
  version: 1.0.0
  description: Schema definition for the Configuration Sheet used to generate forms.
paths: {}
components:
  schemas:
    QuestionConfig:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the question (e.g., Q123). Generated automatically if missing.
        type:
          type: string
          enum: [DATE, TEXT, PARAGRAPH, NUMBER, CHOICE, CHECKBOX, FILE_UPLOAD, LINE_ITEM_GROUP]
          description: The type of the input field.
        qEn:
          type: string
          description: Question text in English.
        qFr:
          type: string
          description: Question text in French.
        qNl:
          type: string
          description: Question text in Dutch.
        required:
          type: boolean
          description: Whether the question is mandatory.
        options:
          type: string
          description: |
            Defines the options for CHOICE/CHECKBOX questions.
            Must be a reference string in the format `REF:SheetName` pointing to a separate sheet.
            The referenced sheet must contain three columns: Options (EN), Options (FR), Options (NL).
            Inline comma-separated lists are also supported for quick setup.
            Ignored for FILE_UPLOAD and LINE_ITEM_GROUP.
        uploadConfig:
          $ref: '#/components/schemas/FileUploadConfig'
          description: Additional settings for FILE_UPLOAD questions. Provide as JSON in the `Config (JSON/REF)` column.
        lineItemConfig:
          $ref: '#/components/schemas/LineItemGroupConfig'
          description: Settings for LINE_ITEM_GROUP questions. Provide as JSON or `REF:SheetName` in the `Config (JSON/REF)` column.
        status:
          type: string
          enum: [Active, Archived]
          description: Status of the question. Archived questions are ignored during form generation.
      required:
        - id
        - type
        - qEn
        - qFr
        - qNl
        - required
        - status

    FileUploadConfig:
      type: object
      properties:
        destinationFolderId:
          type: string
          description: Optional Drive folder ID where uploaded files should be stored.
        maxFiles:
          type: integer
          description: Maximum number of files allowed for this upload question.
        maxFileSizeMb:
          type: number
          description: Maximum file size in MB. Files larger than this are ignored.
        allowedExtensions:
          type: array
          items:
            type: string
          description: List of allowed file extensions (e.g., ['jpg', 'png', 'pdf']).

    LineItemFieldConfig:
      type: object
      properties:
        id:
          type: string
          description: Internal identifier for the line item field.
        type:
          type: string
          enum: [DATE, TEXT, PARAGRAPH, NUMBER, CHOICE, CHECKBOX]
        labelEn:
          type: string
        labelFr:
          type: string
        labelNl:
          type: string
        required:
          type: boolean
        options:
          type: array
          items:
            type: string
        optionsFr:
          type: array
          items:
            type: string
        optionsNl:
          type: array
          items:
            type: string

    LineItemGroupConfig:
      type: object
      properties:
        minRows:
          type: integer
          description: Minimum number of line item rows required.
        maxRows:
          type: integer
          description: Maximum number of line item rows allowed.
        addButtonLabel:
          type: object
          properties:
            en:
              type: string
            fr:
              type: string
            nl:
              type: string
          description: Custom labels for the "Add line" button in each language.
        fields:
          type: array
          items:
            $ref: '#/components/schemas/LineItemFieldConfig'
      required:
        - fields

    LineItemSheet:
      type: array
      description: |
        Structure of the separate sheet referenced by `REF:SheetName` for LINE_ITEM_GROUP questions.
        Columns should be: ID, Type, Label EN, Label FR, Label NL, Required?, Options (EN), Options (FR), Options (NL).
        Type must be one of DATE, TEXT, PARAGRAPH, NUMBER, CHOICE, CHECKBOX.
      items:
        type: object
        properties:
          id:
            type: string
          type:
            type: string
            enum: [DATE, TEXT, PARAGRAPH, NUMBER, CHOICE, CHECKBOX]
          labelEn:
            type: string
          labelFr:
            type: string
          labelNl:
            type: string
          required:
            type: boolean
          options:
            type: string
            description: Option values for CHOICE/CHECKBOX in English, or REF:Options_sheet.
          optionsFr:
            type: string
          optionsNl:
            type: string

    OptionsSheet:
      type: array
      description: |
        Structure of the separate sheet referenced by `REF:SheetName`.
        Contains three columns defining options in each language.
      items:
        type: object
        properties:
          optionEn:
            type: string
            description: Option text in English (Column A).
          optionFr:
            type: string
            description: Option text in French (Column B).
          optionNl:
            type: string
            description: Option text in Dutch (Column C).

    ConfigSheet:
      type: array
      description: A collection of question configurations defining a form.
      items:
        $ref: '#/components/schemas/QuestionConfig'
